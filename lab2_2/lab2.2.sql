DROP SCHEMA IF EXISTS schedule CASCADE;
CREATE SCHEMA schedule;

CREATE TABLE schedule.groups (
    group_id SERIAL PRIMARY KEY,
    faculty_name text NOT NULL,
    course integer CHECK(course >= 1 AND course <= 6),
    group_number text NOT NULL
);

CREATE TABLE schedule.students (
    student_id SERIAL PRIMARY KEY,
    surname text NOT NULL,
    name text NOT NULL,
    patronymic text,
    group_id integer CONSTRAINT student_group REFERENCES schedule.groups ON DELETE CASCADE
);

CREATE TABLE schedule.subjects (
    subject_id SERIAL PRIMARY KEY,
    subject_name text NOT NULL,
    faculty_name text
);

CREATE TABLE schedule.examiners (
    examiner_id SERIAL PRIMARY KEY,
    surname text NOT NULL,
    name text NOT NULL,
    patronymic text
);

CREATE TABLE schedule.timedate (
    timedate_id SERIAL PRIMARY KEY,
    building_name text NOT NULL,
    audience_num text NOT NULL,
    "date" timestamp NOT NULL
);

CREATE TABLE schedule.consultation (
    consultation_id SERIAL PRIMARY KEY,
    timedate_id integer CONSTRAINT cons_timedate REFERENCES schedule.timedate
);

CREATE TABLE schedule.exams (
    exam_id SERIAL PRIMARY KEY,
    subject_id integer CONSTRAINT exam_subject REFERENCES schedule.subjects ON DELETE CASCADE,
    timedate_id integer CONSTRAINT exam_timedate REFERENCES schedule.timedate ON UPDATE CASCADE,
    consultation_id integer DEFAULT NULL CONSTRAINT exam_consultation REFERENCES schedule.consultation ON DELETE SET NULL
);

CREATE TABLE schedule.groups_exams (
    exam_id integer CONSTRAINT gre_exam REFERENCES schedule.exams ON DELETE CASCADE,
    group_id integer CONSTRAINT gre_group REFERENCES schedule.groups ON DELETE CASCADE,
    UNIQUE (exam_id, group_id)
);

CREATE TABLE schedule.exams_examiners (
    exam_id integer CONSTRAINT ee_exam REFERENCES schedule.exams ON DELETE CASCADE,
    examiner_id integer CONSTRAINT ee_examiner REFERENCES schedule.examiners ON DELETE CASCADE,
    UNIQUE (exam_id, examiner_id)
);

CREATE TABLE schedule.examiners_subjects (
    subject_id integer CONSTRAINT es_subject REFERENCES schedule.subjects ON DELETE CASCADE,
    examiner_id integer CONSTRAINT es_examiner REFERENCES schedule.examiners ON DELETE CASCADE,
    UNIQUE (subject_id, examiner_id)
);

INSERT INTO schedule.groups(faculty_name, course, group_number) VALUES
    ('Computational Mathematics and Cybernetics', 1, 101),
    ('Computational Mathematics and Cybernetics', 2, 201),
    ('Mechanics and Mathematics', 1, 101),
    ('Mechanics and Mathematics', 2, 201),
    ('Sociological', 1, 101),
    ('Sociological', 2, 201),
    ('Space Research', 1, 101),
    ('Space Research', 2, 201),
    ('Fundamental Medicine', 1, 101),
    ('Fundamental Medicine', 2, 201),
    ('Geography', 1, 101),
    ('Geography', 2, 201),
    ('Geology', 1, 101),
    ('Geology', 2, 201),
    ('Soil Science', 1, 101),
    ('Soil Science', 2, 201),
    ('Bioengineering and Bioinformatics', 1, 101),
    ('Bioengineering and Bioinformatics', 2, 201),
    ('Physical', 1, 101),
    ('Physical', 2, 201),
	('Computational Mathematics and Cybernetics', 2, 202),
	('Computational Mathematics and Cybernetics', 2, 203),
	('Computational Mathematics and Cybernetics', 2, 204);
INSERT INTO schedule.students (surname, name, patronymic, group_id) VALUES
    ('Тютиков', 'Эдуард', 'Леонидович', 1),
    ('Люкшинова', 'Карина', 'Альбертовна', 2),
    ('Курылкин', 'Геннадий', 'Ярославович', 3),
    ('Грачевская', 'Анна', 'Антоновна', 4),
	('Демина', 'Марина', 'Казимировна', 5),
	('Носова', 'Римма', 'Олеговна', 6),
	('Куанышбаев', 'Тихон', 'Данилович', 7),
	('Бабин', 'Вадим', 'Олегович', 8),
	('Гавшина', 'Юлиана', 'Васильевна', 9),
	('Панарин', 'Эмиль', 'Альбертович', 10),
	('Завразин', 'Михей', 'Егорович', 11),
	('Новоселов', 'Ян', 'Леонтиевич', 12),
	('Поликарпова', 'Василиса', 'Адамовна', 13),
	('Подшивалова', 'Алина', 'Тихоновна', 14),
	('Лобан', 'Эмир', 'Сидорович', 15),
	('Ядренникова', 'Всеслава', 'Олеговна', 16),
	('Фамусов', 'Станислав', 'Каримович', 17),
	('Рашет', 'Александр', 'Анатольевич', 18),
	('Язьков', 'Билал', 'Левович', 19),
	('Юдачёва', 'Дина', 'Антониновна', 20),
	('Абакумова', 'Алиса', 'Георгиевна', 21), 
	('Арнгольд', 'Анна', 'Петровна', 22),
	('Верещагин', 'Матвей', 'Алексеевич', 23),
	('Давидок', 'Олег', 'Константинович', 21),
	('Добычина', 'Ксения', 'Олеговна', 22),
	('Комиссарова', 'София', 'Арменовна', 23),
	('Краснавчук', 'Никита', 'Владимирович', 21),
	('Левонян', 'Армен', 'Владиславович', 22),
	('Мятлева', 'Алена', 'Андреевна', 23),
	('Нистерюк', 'Владислав','Максимович', 1),
	('Опрятнова', 'Нелли', 'Яновна', 2),
	('Пахомова', 'Софья', 'Денисовна', 3),
	('Сивакова', 'Таисия', 'Станиславовна', 4),
	('Степанов', 'Платон', 'Денисович', 4),
	('Титов', 'Денис', 'Динарович', 5),
	('Устинова', 'Дарья', 'Александровна', 5),
	('Шакеров', 'Динар', 'Алексеевич', 6),
	('Шоров', 'Станислав', 'Федорович', 7),
	('Яковлев', 'Кирилл', 'Арсеньевич', 8),
	('Агададашев', 'Артём', 'Федотович', 9),
	('Бен', 'Афия', 'Андреевна', 10),
	('Верхогляд', 'Валентин', 'Константинович', 11),
	('Гибадулин', 'Богдан', 'Кириллович', 12),
	('Гнатко', 'Константин', 'Георгиевич', 13),
	('Петрухина', 'Ерина', 'Максимовна', 14),
	('Ермоленко', 'Кирилл', 'Петрович', 15),
	('Ким', 'Константин',  'Константинович', 16),
	('Клопов', 'Иван', 'Владиславович', 17),
	('Королёва', 'Алиса', 'Динаровна', 18),
	('Косарева', 'Виктория', 'Александровна', 19),
	('Кофанов', 'Максим', 'Федотович', 20),
	('Левчишина', 'Мария', 'Андреевна', 6),
	('Малькова', 'Василиса', 'Кириллович', 7),
	('Семёнов', 'Максим', 'Егорович', 8),
	('Трохин', 'Вадим', 'Иванович', 9),
	('Хлебников', 'Егор', 'Максимович', 10),
	('Цитлидзе', 'Габриэла', 'Александровна', 11),
	('Блесткин', 'Артем', 'Владимирович', 12),
	('Вавула', 'Кирилл', 'Андреевич', 13),
	('Вялова', 'Алиса', 'Константиновна', 14),
	('Гурулева', 'Анна', 'Дмитриевна', 15),
	('Даценко', 'Анна', 'Александровна', 16),
	('Дунаев', 'Данила', 'Сергеевич', 17),
	('Иванов', 'Алексей', 'Витальевич', 18),
	('Ионченкова', 'Полина', 'Игоревна', 19),
	('Каргин', 'Леонид', 'Олегович', 20);

INSERT INTO schedule.subjects (subject_name, faculty_name) VALUES
	('Линейная алгебра','Computational Mathematics and Cybernetics' ),
	('Математический анализ', 'Bioengineering and Bioinformatics'),
	('Классическая механика', 'Physical'),
	('ОСИ', 'Computational Mathematics and Cybernetics'),
	('Программирование','Mechanics and Mathematics'),
	('Философия','Sociological' ),
	('Математический анализ', 'Space Research'),
	('Гистология','Fundamental Medicine'),
	('Биология','Soil Science'),
	('Почвоведение','Geology'),
	('Картография', 'Geography'),
	('Теория множеств','Computational Mathematics and Cybernetics' ),
	('Функциональный анализ', 'Bioengineering and Bioinformatics'),
	('Квантовая механика', 'Physical'),
	('Электродинамика', 'Computational Mathematics and Cybernetics'),
	('Высшая математика','Mechanics and Mathematics'),
	('Экономика','Sociological' ),
	('Космонавтика', 'Space Research'),
	('Фармацевтика','Fundamental Medicine'),
	('Химия','Soil Science'),
	('География','Geology'),
	('Высшая математика', 'Geography');
	

INSERT INTO schedule.timedate(building_name, audience_num, date) VALUES
	('ВМК', 'П1', TIMESTAMP '2020-06-05 09:00:00'),
	('ВМК', 'П6', TIMESTAMP '2020-06-05 09:00:00'),
	('ГЗ', '110', TIMESTAMP '2020-06-04 09:00:00'),
	('ГЗ', '115', TIMESTAMP '2020-06-04 09:00:00'),
	('ГЗ', '223', TIMESTAMP '2020-06-06 09:00:00'),
	('ГЗ', '232', TIMESTAMP '2020-06-09 09:00:00'),
	('ГЗ', '170', TIMESTAMP '2020-06-07 09:00:00'),
	('ГЗ', '175', TIMESTAMP '2020-06-08 09:00:00'),
	('Шуваловский', 'П5', TIMESTAMP '2020-06-08 09:00:00'),
	('Шуваловский', 'П5', TIMESTAMP '2020-06-09 09:00:00'),
	('Шуваловский', 'П2', TIMESTAMP '2020-06-03 09:00:00'),
	('Шуваловский', 'П3', TIMESTAMP '2020-06-03 09:00:00'),
	('Шуваловский', 'П10', TIMESTAMP '2020-06-07 09:00:00'),
	('Шуваловский', 'П1', TIMESTAMP '2020-06-08 09:00:00'),
	('Ломоносовский', 'П3', TIMESTAMP '2020-06-05 09:00:00'),
	('Ломоносовский', 'П4', TIMESTAMP '2020-06-12 09:00:00'),
	('Ломоносовский', 'П5', TIMESTAMP '2020-06-15 09:00:00'),
	('Ломоносовский', 'П3', TIMESTAMP '2020-06-11 09:00:00'),
	('Ломоносовский', 'П7', TIMESTAMP '2020-06-09 09:00:00'),
	('Ломоносовский', 'П10', TIMESTAMP '2020-06-17 09:00:00'),
	('ВМК', 'П1', TIMESTAMP '2020-06-04 09:00:00'),
	('ВМК', 'П6', TIMESTAMP '2020-06-04 09:00:00'),
	('ГЗ', '110', TIMESTAMP '2020-06-03 09:00:00 '),
	('ГЗ', '115', TIMESTAMP '2020-06-03 09:00:00'),
	('ГЗ', '223', TIMESTAMP '2020-06-05 09:00:00'),
	('ГЗ', '232', TIMESTAMP '2020-06-08 09:00:00'),
	('ГЗ', '170', TIMESTAMP '2020-06-06 09:00:00'),
	('ГЗ', '175', TIMESTAMP '2020-06-07 09:00:00'),
	('Шуваловский', 'П5', TIMESTAMP '2020-06-06 09:00:00'),
	('Шуваловский', 'П5', TIMESTAMP '2020-06-07 09:00:00'),
	('Шуваловский', 'П2', TIMESTAMP '2020-06-02 09:00:00'),
	('Шуваловский', 'П3', TIMESTAMP '2020-06-02 09:00:00'),
	('Шуваловский', 'П10', TIMESTAMP '2020-06-06 09:00:00'),
	('Шуваловский', 'П1', TIMESTAMP '2020-06-07 09:00:00'),
	('Ломоносовский', 'П3', TIMESTAMP '2020-06-04 09:00:00'),
	('Ломоносовский', 'П4', TIMESTAMP '2020-06-11 09:00:00'),
	('Ломоносовский', 'П5', TIMESTAMP '2020-06-14 09:00:00'),
	('Ломоносовский', 'П3', TIMESTAMP '2020-06-10 09:00:00'),
	('Ломоносовский', 'П7', TIMESTAMP '2020-06-08 09:00:00'),
	('Ломоносовский', 'П10', TIMESTAMP '2020-06-16 09:00:00'),
	('ВМК', 'П2', TIMESTAMP '2020-06-05 09:00:00'),
	('ВМК', 'П5', TIMESTAMP '2020-06-05 09:00:00'),
	('ГЗ', '210', TIMESTAMP '2020-06-04 09:00:00'),
	('ГЗ', '215', TIMESTAMP '2020-06-04 09:00:00'),
	('ГЗ', '123', TIMESTAMP '2020-06-06 09:00:00'),
	('ГЗ', '132', TIMESTAMP '2020-06-09 09:00:00'),
	('ГЗ', '270', TIMESTAMP '2020-06-07 09:00:00'),
	('ГЗ', '275', TIMESTAMP '2020-06-08 09:00:00'),
	('Шуваловский', 'П4', TIMESTAMP '2020-06-08 09:00:00'),
	('Шуваловский', 'П4', TIMESTAMP '2020-06-09 09:00:00'),
	('Шуваловский', 'П6', TIMESTAMP '2020-06-03 09:00:00'),
	('Шуваловский', 'П7', TIMESTAMP '2020-06-03 09:00:00'),
	('Шуваловский', 'П11', TIMESTAMP '2020-06-07 09:00:00'),
	('Шуваловский', 'П8', TIMESTAMP '2020-06-08 09:00:00'),
	('Ломоносовский', 'П1', TIMESTAMP '2020-06-05 09:00:00'),
	('Ломоносовский', 'П2', TIMESTAMP '2020-06-12 09:00:00'),
	('Ломоносовский', 'П6', TIMESTAMP '2020-06-15 09:00:00'),
	('Ломоносовский', 'П1', TIMESTAMP '2020-06-11 09:00:00'),
	('Ломоносовский', 'П8', TIMESTAMP '2020-06-09 09:00:00'),
	('Ломоносовский', 'П9', TIMESTAMP '2020-06-17 09:00:00'),
	('ВМК', 'П2', TIMESTAMP '2020-06-04 09:00:00'),
	('ВМК', 'П5', TIMESTAMP '2020-06-04 09:00:00'),
	('ГЗ', '210', TIMESTAMP '2020-06-03 09:00:00 '),
	('ГЗ', '215', TIMESTAMP '2020-06-03 09:00:00'),
	('ГЗ', '123', TIMESTAMP '2020-06-05 09:00:00'),
	('ГЗ', '132', TIMESTAMP '2020-06-08 09:00:00'),
	('ГЗ', '270', TIMESTAMP '2020-06-06 09:00:00'),
	('ГЗ', '275', TIMESTAMP '2020-06-07 09:00:00'),
	('Шуваловский', 'П4', TIMESTAMP '2020-06-06 09:00:00'),
	('Шуваловский', 'П4', TIMESTAMP '2020-06-07 09:00:00'),
	('Шуваловский', 'П6', TIMESTAMP '2020-06-02 09:00:00'),
	('Шуваловский', 'П7', TIMESTAMP '2020-06-02 09:00:00'),
	('Шуваловский', 'П11', TIMESTAMP '2020-06-06 09:00:00'),
	('Шуваловский', 'П8', TIMESTAMP '2020-06-07 09:00:00'),
	('Ломоносовский', 'П1', TIMESTAMP '2020-06-04 09:00:00'),
	('Ломоносовский', 'П2', TIMESTAMP '2020-06-11 09:00:00'),
	('Ломоносовский', 'П6', TIMESTAMP '2020-06-14 09:00:00'),
	('Ломоносовский', 'П1', TIMESTAMP '2020-06-10 09:00:00'),
	('Ломоносовский', 'П8', TIMESTAMP '2020-06-08 09:00:00'),
	('Ломоносовский', 'П9', TIMESTAMP '2020-06-16 09:00:00');
INSERT INTO schedule.consultation(timedate_id) VALUES
	(21),
	(22),
	(23),
	(24),
	(25),
	(26),
	(27),
	(28),
	(29),
	(30),
	(31),
	(32),
	(33),
	(34),
	(35),
	(36),
	(37),
	(38),
	(39),
	(40),
	(61),
	(62),
	(63),
	(64),
	(65),
	(66),
	(67),
	(68),
	(69),
	(70),
	(71),
	(72),
	(73),
	(74),
	(75),
	(76),
	(77),
	(78),
	(79),
	(80);

INSERT INTO schedule.exams(subject_id, timedate_id, consultation_id) VALUES
	(1, 1, 1),
	(2, 2, 2),
	(3, 3, 3),
	(4, 4, 4),
	(5, 5, 5),
	(6, 6, 6),
	(7, 7, 7),
	(8, 8, 8),
	(9, 9, 9),
	(10, 10, 10),
	(11, 11, 11),
	(2, 12, 12),
	(3, 13, 13),
	(5, 14, 14),
	(6, 15, 15),
	(7, 16, 16),
	(8, 17, 17),
	(9, 18, 18),
	(10, 19, 19),
	(11, 20, 20),
	(12, 21, 21),
	(13, 22, 22),
	(14, 23, 23),
	(15, 24, 24),
	(16, 25, 25),
	(17, 26, 26),
	(18, 27, 27),
	(19, 28, 28),
	(20, 29, 29),
	(21, 30, 30),
	(22, 31, 31),
	(13, 32, 32),
	(14, 33, 33),
	(16, 34, 34),
	(17, 35, 35),
	(18, 36, 36),
	(19, 37, 37),
	(20, 38, 38),
	(21, 39, 39),
	(22, 40, 40);
	
INSERT INTO schedule.groups_exams(group_id, exam_id) VALUES
	(1,	1),
	(2,	4),
	(3,	5),
	(4,	14),
	(5,	6),
	(6,	15),
	(7,	7),
	(8,	16),
	(9,	8),
	(10, 17),
	(11, 11),
	(12, 18),
	(13, 10),
	(14, 19),
	(15, 9),
	(16, 9),
	(17, 2),
	(18, 12),
	(19, 3),
	(20, 13),
	(21, 4),
	(22, 4),
	(23, 4),
	(1,	21),
	(2,	24),
	(3,	25),
	(4,	34),
	(5,	26),
	(6,	35),
	(7,	27),
	(8,	36),
	(9,	28),
	(10, 37),
	(11, 31),
	(12, 38),
	(13, 30),
	(14, 39),
	(15, 29),
	(16, 29),
	(17, 22),
	(18, 32),
	(19, 23),
	(20, 33),
	(21, 24),
	(22, 24),
	(23, 24),
	(5, 20),
	(11, 40);
	
	
	
INSERT INTO schedule.examiners (surname, name, patronymic) VALUES
    ('Бушманов', 'Василий', 'Леонидович'),
    ('Валуйсих', 'Мария', 'Альбертовна'),
  	('Ветров', 'Георгий', 'Ярославович'),
  	('Дандина', 'Анна', 'Антоновна'),
  	('Данилова', 'Марина', 'Казимировна'),
  	('Коптева', 'Римма', 'Олеговна'),
  	('Кострыкин', 'Тихон', 'Данилович'),
  	('Михнов', 'Вадим', 'Олегович'),
  	('Олейник', 'Юлиана', 'Васильевна'),
  	('Ольшанский', 'Эмиль', 'Альбертович'),
  	('Пахмчик', 'Михей', 'Егорович'),
  	('Петров', 'Даниил', 'Леонтиевич'),
  	('Полицинская', 'Ангелина', 'Адамовна'),
  	('Сапленкова', 'Елена', 'Тихоновна'),
  	('Урывский', 'Эмиль', 'Сидорович'),
  	('Шуваева', 'Ярослава', 'Олеговна'),
  	('Трофимов', 'Владислав', 'Каримович'),
  	('Прохоров', 'Иван', 'Анатольевич'),
  	('Шаляпин', 'Андрей', 'Левович'),
  	('Кузнецова', 'Зинаида', 'Антониновна'),
	('Кермина', 'Виктория', 'Алексеевна'),
	('Коростылев', 'Даниил', 'Юрьевич'),
	('Магда', 'Яна', 'Дмитриевна'),
	('Милютина', 'Анна', 'Дмитриевна'),
	('Паутова', 'Виктория', 'Дмитриевна'),
	('Попова', 'Ульяна', 'Александровна'),
	('Пушкина', 'Карина', 'Игоревна'),
	('Реут', 'София', 'Игоревна'),
	('Румянцев', 'Денис', 'Олегович'),
	('Самоделов', 'Тимофей', 'Александрович'),
	('Серушкин', 'Егор', 'Юрьевич'),
	('Терёхина', 'Нина', 'Денисовна'),
	('Тимофеева', 'Ульяна', 'Андреевна'),
	('Цапкова', 'Кристина', 'Александровна'),
	('Цыганок', 'Глеб', 'Антонович'),
	('Чесновская', 'Елизавета', 'Станиславовна'),
	('Чуфранов', 'Алексей', 'Георгиевич'),
	('Шакура', 'Фёдор', 'Владимирович'),
	('Шейнов', 'Владимир', 'Денисович'),
	('Щусова', 'Арина', 'Артемовна');
INSERT INTO schedule.exams_examiners(exam_id, examiner_id) VALUES
	(1,	1),
	(2,	2),
	(3,	3),
	(4,	4),
	(5,	5),
	(6,	6),
	(7,	7),
	(8,	8),
	(9,	9),
	(10, 10),
	(11, 11),
	(12, 12),
	(13, 13),
	(14, 14),
	(15, 15),
	(16, 16),
	(17, 17),
	(18, 18),
	(19, 19),
	(20, 20),
	(21, 21),
	(22, 22),
	(23, 23),
	(24, 24),
	(25, 25),
	(26, 26),
	(27, 27),
	(28, 28),
	(29, 29),
	(30, 30),
	(31, 31),
	(32, 32),
	(33, 33),
	(34, 34),
	(35, 35),
	(36, 36),
	(37, 37),
	(38, 38),
	(39, 39),
	(40, 40);
	
INSERT INTO schedule.examiners_subjects(examiner_id, subject_id) VALUES
	(1,	1),
	(2,	2),
	(3,	3),
	(4,	4),
	(5,	5),
	(6,	6),
	(7,	7),
	(8,	8),
	(9,	9),
	(10, 10),
	(11, 11),
	(12, 2),
	(13, 4),
	(14, 5),
	(15, 6),
	(16, 7),
	(17, 8),
	(18, 9),
	(19, 10),
	(20, 11),
	(21, 12),
	(22, 13),
	(23, 14),
	(24, 15),
	(25, 16),
	(26, 17),
	(27, 18),
	(28, 19),
	(29, 20),
	(30, 21),
	(31, 22),
	(32, 13),
	(33, 14),
	(34, 16),
	(35, 17),
	(36, 18),
	(37, 19),
	(38, 20),
	(39, 21),
	(40, 22);
